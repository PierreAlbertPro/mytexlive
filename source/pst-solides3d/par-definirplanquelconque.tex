\section {Définir un plan quelconque de projection}

Pour définir un plan de projection, on suppose que le dessin à projeter
est sur le plan $Oxy$, et l'utilisateur doit préciser l'image de la
base $(O, \overrightarrow {\imath }, \overrightarrow {\jmath },
\overrightarrow k)$. Afin d'alléger la syntaxe, le minimum demandé à
l'utilisateur est de préciser l'image de l'origine $O$ et l'image de
$\overrightarrow k$, autrement dit de préciser l'image de l'origine et
les coordonnées d'un vecteur normal au plan de projection.

Le package propose alors une orientation du plan de projection. Si
l'utilisateur n'est pas satisfait de cette orientation, il peut la
préciser.

Les paragraphes qui suivent détaillent la syntaxe proposée.

\subsection{L'origine}

\Cadre{(x,y,z)} sont les coordonnées de l'origine du plan, ce sont
soit des valeurs numériques, soit des expressions calculables par
l'interpréteur \texttt{postscript}.

\Cadre{$\backslash$psProjection[\ldots](1,2,3)} placera l'origine du
plan au point de coordonnées $(1,2,3)$.


\Cadre{$\backslash$psProjection[\ldots](0.5 0.5 add,2 sqrt,1.5 2 exp)}
placera l'origine du plan au point de coordonnées
$(1,\sqrt{2},1.5^2)$.

S'il n'y a rien, pas de coordonnées à la fin de la commande, celle-ci
l'interprète comme $(0,0,0)$ et place donc l'origine en O.

\subsection{Définir la normale au plan}

Il y a deux façons de définir la normale au plan et la possibilité de
faire tourner le repère du plan d'un angle donné autour de cette
normale suivant la façon dont on écrit l'argument de l'option :
\texttt{|normal=...]}

\subsubsection{Méthode 1 : donner les coordonnées du vecteur normal}

Dans ce cas l'argument de \Cadre{[normal=nx ny nz]} comprend trois
valeurs : les coordonnées du vecteur normal, par exemple ici
\texttt{[normal=0 0 1]} pour le plan $Oxy$.

\vfill

\begin{minipage}{6cm}
\psset{unit=0.5}
\begin{pspicture}(-6,-6)(6,6)
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=10 -20 50,SphericalCoor,viewpoint=50 20 30,Decran=50}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]}
\defFunction[algebraic]{f1}(x){3*cos(x)}{3*sin(x)}{}
\psProjection[object=courbeR2,
   range=-3.14 3.14,
   linecolor=blue,
   normal=0 0 1 ,
   function=f1]
\axesIIID(0,0,0)(4,4,4)
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=red,
      normal=1 0 0,
      path=
         newpath
            0 0 smoveto
            -1 0 slineto]
%\psProjection[object=chemin,
%      linewidth=.1,
%      linecolor=blue,
%      normal=1 0 0,
%      path=
%         newpath
%            0 0 moveto
%            0 1 lineto]
\rput(0,-6.5){\psframebox[linecolor=blue!50]{\texttt{$\backslash${}defFunction[algebraic]\{f\}(x)\{3*cos(x)\}\{3*sin(x)\}\{\}}}}
\end{pspicture}
\end{minipage}
\hfill
\begin{minipage}{8cm}
%%\begin{boxedverbatim}
\begin{verbatim}
\psSolid[object=grille,base=-4 4 -4 4]
\psProjection[object=courbeR2,
                    range=-3.14 3.14,
                    linecolor=blue,
                    normal=0 0 1,
                    function=f]
\end{verbatim}
%%\end{boxedverbatim}
\end{minipage}
\vfill
Si on appelle
$\big(\overrightarrow{i}(1,0,0),\overrightarrow{j}(0,1,0),\overrightarrow{k}(0,0,1)\big)$
les vecteurs du repère de référence et par
$\big(\overrightarrow{I},\overrightarrow{J},\overrightarrow{K}\big)$
ceux du repère lié au plan à définir, les relations suivantes sont
vérifiées, en rappelant que $\overrightarrow{K}$ est le vecteur normal
choisi :
\begin{enumerate}
  \item $\overrightarrow{J}=\overrightarrow{K}\wedge \overrightarrow{i}$
  \item $\overrightarrow{I}=\overrightarrow{J}\wedge \overrightarrow{K}$
\end{enumerate}
Si $\overrightarrow{K}=\overrightarrow{i}$ on prend $\overrightarrow{J}=\overrightarrow{j}$

 En prenant comme convention que $\overrightarrow{K}$ sera dessiné en
 rouge, $\overrightarrow{J}$ en bleu et $\overrightarrow{I}$ en vert,
 illustrons par des exemples ces relations.

\vfill
\begin{minipage}{0.3\linewidth}
\psset{unit=0.4}
\psframebox{\centerline{\texttt{[normal=0 0 1]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=10 -20 50,SphericalCoor,viewpoint=50 20 30,Decran=60}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]}
\axesIIID(0,0,0)(4,4,4)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=red,
      normal=1 0 0,
      path=
         newpath
            0 0 smoveto
            -1 0 slineto]
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=blue,
      normal=0 0 1,
      path=
         newpath
            0 0 smoveto
            0 1 slineto]
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=green,
      normal=0 0 1,
      path=
         newpath
            0 0 smoveto
            1 0 slineto]
\end{pspicture}
\end{minipage}
\hfill
\begin{minipage}{0.3\linewidth}
\psset{unit=0.4}
\psframebox{\centerline{\texttt{[normal=1 0 0]}}}

\begin{pspicture}(-6,-6)(6,7)
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 20 30,viewpoint=50 20 30,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4,RotY=90]}
\axesIIID(0,0,0)(4,4,4)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=green,
      normal=1 0 0,
      path=
         newpath
            0 0 smoveto
            1 0 slineto]
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=blue,
      normal=1 0 0,
      path=
         newpath
            0 0 smoveto
            0 1 slineto]
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=red,
      normal=0 0 1,
      path=
         newpath
            0 0 smoveto
            1 0 slineto]
\end{pspicture}
\end{minipage}
\hfill
\begin{minipage}{0.3\linewidth}
\psset{unit=0.4}

\psframebox{\centerline{\texttt{[normal=0 1 0]}}}

\begin{pspicture}(-6,-6)(6,7)
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 60 30,viewpoint=50 60 30,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4,RotX=-90]}
\axesIIID(0,0,0)(4,4,4)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=green,
      normal=0 1 0,
      path=
         newpath
            0 0 smoveto
            1 0 slineto]
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=blue,
      normal=0 1 0,
      path=
         newpath
            0 0 smoveto
            0 1 slineto]
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=red,
      normal=0 0 1,
      path=
         newpath
            0 0 smoveto
            0 1 slineto]
\end{pspicture}
\end{minipage}

\vfill

\begin{minipage}{0.3\linewidth}
\psset{unit=0.4}
\psframebox{\centerline{\texttt{[normal=1 0 1]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 20 20,viewpoint=50 20 20,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]
\psSolid[object=grille,base=-4 0 -4 4,RotY=90]
\psSolid[object=grille,base=-2 2 -4 4,RotY=45,linecolor=red](1.414,0,1.414)}
\psPoint(2,0,2){O1}%\psdot(O1)
\axesIIID(2.8,3,2.8)(4,4,4)
\psPoint(1.414,0,1.414){O1}\psPoint(2.414,0,2.414){OK}
\psline[linewidth=.2,linecolor=red](O1)(OK)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=blue,
      normal=1 0 1,
      path=
         newpath
            0 0 smoveto
            0 1 slineto](1.414,0,1.414)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=green,
      normal=1 0 1,
      path=
         newpath
            0 0 smoveto
            1 0 slineto](1.414,0,1.414)
\end{pspicture}
\end{minipage}
\hfill
\begin{minipage}{0.3\linewidth}
\psset{unit=0.4}
\psframebox{\centerline{\texttt{[normal=0 1 1]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=30 20 20,viewpoint=30 20 20,Decran=45}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]
\psSolid[object=grille,base=-4 0 -4 4,RotY=90,RotZ=90]
\psSolid[object=grille,base=-4 4 -2 2,RotX=-45,linecolor=red](0,1.414,1.414)}
\axesIIID(2.8,3,2.8)(4,4,4)
\psPoint(0,1.414,1.414){O1}\psPoint(0,2.414,2.414){OK}
\psline[linewidth=.2,linecolor=red](O1)(OK)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=blue,
      normal=0 1 1,
      path=
         newpath
            0 0 smoveto
            0 1 slineto](0,1.414,1.414)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=green,
      normal=0 1 1,
      path=
         newpath
            0 0 smoveto
            1 0 slineto](0,1.414,1.414)
\end{pspicture}
\end{minipage}
\hfill
\begin{minipage}{0.3\linewidth}
\psset{unit=0.4}
\psframebox{\centerline{\texttt{[normal=1 1 0]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=30 20 20,viewpoint=30 20 20,Decran=45}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=0 2 -4 4,RotY=90,RotZ=45,linecolor=red](1.414,1.414,0)
\psSolid[object=grille,base=-4 4 -4 4]
\psSolid[object=grille,base= -2 0 -4 4,RotY=90,RotZ=45,linecolor=red](1.414,1.414,0)}
\axesIIID(2.8,2.8,1)(4,4,4)
\psPoint(1.414,1.414,0){O1}\psPoint(2.414,2.414,0){OK}
\psline[linewidth=.2,linecolor=red](O1)(OK)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=blue,
      normal=1 1 0,
      path=
         newpath
            0 0 smoveto
            0 1 slineto](1.414,1.414,0)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=green,
      normal=1 1 0,
      path=
         newpath
            0 0 smoveto
            1 0 slineto](1.414,1.414,0)
\end{pspicture}
\end{minipage}

\vfill

\newpage

\subsubsection{Méthode 2 : donner les coordonnées du vecteur normal et l'angle de rotation}

Dans ce cas l'argument de \texttt{[normal=nx ny nz A]} comprend
quatre valeurs : les coordonnées du vecteur normal et l'angle de
rotation en degrés autour de cet axe.

\begin{minipage}{0.4\linewidth}
\psset{unit=0.5}
\psframebox{\centerline{\texttt{[normal=1 0 1]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 20 20,viewpoint=50 20 20,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]
\psSolid[object=grille,base=-4 0 -4 4,RotY=90]
\psSolid[object=grille,base=-2 2 -4 4,RotY=45,linecolor=red](1.414,0,1.414)}
\psPoint(2,0,2){O1}%\psdot(O1)
\axesIIID(2.8,3,2.8)(4,4,4)
\psPoint(1.414,0,1.414){O1}\psPoint(2.414,0,2.414){OK}
\psline[linewidth=.2,linecolor=red](O1)(OK)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=blue,
      normal=1 0 1,
      path=
         newpath
            0 0 smoveto
            0 1 slineto](1.414,0,1.414)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=green,
      normal=1 0 1,
      path=
         newpath
            0 0 smoveto
            1 0 slineto](1.414,0,1.414)
\defFunction[algebraic]{fonction}(x){cos(x)}{x}{}
\psProjection[object=courbeR2,
   range=-4 4,
   normal=1 0 1,
   function=fonction](1.414,0,1.414)
\end{pspicture}
\end{minipage}
\hfill
\begin{minipage}{0.4\linewidth}
\psset{unit=0.5}
\psframebox{\centerline{\texttt{[normal=1 0 1 45]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 20 20,viewpoint=50 30 20,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4,action=draw]
\psSolid[object=grille,base=-4 4 -4 4,RotY=90,action=draw]}
\axesIIID(0,0,0)(4,4,4)
\psPoint(1.414,0,1.414){O1}\psPoint(2.414,0,2.414){OK}
\psline[linewidth=.2,linecolor=red](O1)(OK)
\psProjection[object=chemin,
      linewidth=.02,
      linecolor=red,
      normal=1 0 1 45,
      path=newpath
          -2 1 2
          {-4 smoveto
           0 8 srlineto} for
           -4 1 4
          {-2 exch smoveto
           4 0 srlineto} for
            ](1.414,0,1.414)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=blue,
      normal=1 0 1 45,
      path=
         newpath
            0 0 smoveto
            0 1 slineto](1.414,0,1.414)
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=green,
      normal=1 0 1 45,
      path=
         newpath
            0 0 smoveto
            1 0 slineto](1.414,0,1.414)
\defFunction[algebraic]{fonction}(x){cos(x)}{x}{}
\psProjection[object=courbeR2,
   range=-4 4,
   normal=1 0 1 45 ,
   function=fonction](1.414,0,1.414)
\end{pspicture}
\end{minipage}

%\newpage
Dans la deuxième figure la normale (représentée en rouge) est
identique à la première figure, mais le plan a tourné d'un angle égal
à 45 degrés autour de cette normale.

\subsubsection{Méthode 3 : définir la normale par les images de \textit{i} et \textit{k}}

Dans ce cas l'argument de \texttt{[normal=ix iy iz kx ky kz]}
comprend six valeurs : les coordonnées des images de
$\overrightarrow{i}$ et $\overrightarrow{k}$, avec :
$\overrightarrow{J}=\overrightarrow{K}\wedge \overrightarrow{I}$.

\begin{minipage}{0.4\linewidth}
\psset{unit=0.5}
\psframebox{\centerline{\texttt{[normal=0 1 0 1 0 0]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 20 20,viewpoint=50 30 20,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]%
\psSolid[object=grille,base=-4 4 -4 4,action=draw,RotX=90,RotZ=90]}%
\defFunction[algebraic]{fonction}(x){x}{x*sin(x)}{}
\axesIIID(0,0,0)(4,4,4)
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=green,
      normal=0 1 0 1 0 0,
      path=
         newpath
            0 0 smoveto
            1 0 slineto]
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=blue,
      normal=0 1 0 1 0 0,
      path=
         newpath
            0 0 smoveto
            0 1 slineto]
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=red,
      normal=0 0 1,
      path=
         newpath
            0 0 smoveto
            1 0 slineto]
\psProjection[object=courbeR2,
   range=-4 4,
   linecolor=green,
   normal=0 1 0 1 0 0,
   function=fonction]
\end{pspicture}
\end{minipage}
\hfill
\begin{minipage}{0.4\linewidth}
\psset{unit=0.5}
\psframebox{\centerline{\texttt{[normal=-1 1 0 1 1 2 ]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 20 20,viewpoint=50 30 20,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]}%
\defFunction[algebraic]{fonction}(x){x}{x*sin(x)}{}
\axesIIID(0,0,0)(4,4,4)
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=green,
      normal=-1 1 0 1 1 2 ,
      path=
         newpath
            0 0 smoveto
            1 0 slineto]
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=blue,
      normal=-1 1 0 1 1 2 ,
      path=
         newpath
            0 0 smoveto
            0 1 slineto]
\psPoint(0,0,0){O}\psPoint(0.4,0.4,0.8){K}
\psline[linewidth=.1,linecolor=red](O)(K)
\psProjection[object=courbeR2,
   range=-4 4,
   linecolor={[cmyk]{1,0,1,0.5}},
   normal=-1 1 0 1 1 2 ,
   function=fonction]
\psProjection[object=chemin,
      linewidth=.02,
      linecolor=red,
      normal=-1 1 0 1 1 2,
      path=newpath
          -4 1 4
          {-4 exch smoveto
           8 0 srlineto} for
           -4 1 4
          {-4 smoveto
           0 8 srlineto} for
            ]
\end{pspicture}
\end{minipage}

\subsubsection{Méthode 4 : définir la normale par les images de
  \textit{i}, de \textit{k} et un angle de rotation}

Dans ce cas l'argument de \texttt{[normal=ix iy iz kx ky kz phi]}
comprend sept valeurs : les coordonnées des images de
$\overrightarrow{i}$, de $\overrightarrow{k}$ et l'angle de rotaion en
degrés autour de la normale, avec :
$\overrightarrow{J}=\overrightarrow{K}\wedge \overrightarrow{I}$.

\begin{minipage}{0.4\linewidth}
\psset{unit=0.5}
\psframebox{\centerline{\texttt{[normal=0 1 0 1 0 0 90]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 20 20,viewpoint=50 30 20,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]%
\psSolid[object=grille,base=-4 4 -4 4,action=draw,RotX=90,RotZ=90]}%
\defFunction[algebraic]{fonction}(x){x}{x*sin(x)}{}
\axesIIID(0,0,0)(4,4,4)
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=green,
      normal=0 1 0 1 0 0 90,
      path=
            0 0 smoveto
            1 0 slineto]
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=blue,
      normal=0 1 0 1 0 0 90,
      path=
            0 0 smoveto
            0 1 slineto]
\psProjection[object=chemin,
      linewidth=.2,
      linecolor=red,
      normal=0 0 1,
      path=
            0 0 smoveto
            1 0 slineto]
\psProjection[object=courbeR2,
   range=-4 4,
   linecolor=green,
   normal=0 1 0 1 0 0 90,
   function=fonction]
\end{pspicture}
\end{minipage}
\hfill
\begin{minipage}{0.4\linewidth}
\psset{unit=0.5}
\psframebox{\centerline{\texttt{[normal=-1 1 0 1 1 2 90]}}}

\begin{pspicture}(-6,-6)(6,7)%
\psframe*[linecolor=blue!50](-6,-6)(6,6)
\psset{lightsrc=50 20 20,viewpoint=50 30 20,Decran=70}
{\psset{linewidth=0.5\pslinewidth,linecolor=gray}
\psSolid[object=grille,base=-4 4 -4 4]}%
\defFunction[algebraic]{fonction}(x){x}{x*sin(x)}{}
\axesIIID(0,0,0)(4,4,4)
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=green,
      normal=-1 1 0 1 1 2 90,
      path=
         newpath
            0 0 smoveto
            1 0 slineto]
\psProjection[object=chemin,
      linewidth=.1,
      linecolor=blue,
      normal=-1 1 0 1 1 2 90,
      path=
         newpath
            0 0 smoveto
            0 1 slineto]
\psPoint(0,0,0){O}\psPoint(0.4,0.4,0.8){K}
\psline[linewidth=.1,linecolor=red](O)(K)
\psProjection[object=courbeR2,
   range=-4 4,
   linecolor={[cmyk]{1,0,1,0.5}},
   normal=-1 1 0 1 1 2 90,
   function=fonction]
\psProjection[object=chemin,
      linewidth=.02,
      linecolor=red,
      normal=-1 1 0 1 1 2,
      path=newpath
          -4 1 4
          {-4 exch smoveto
           8 0 srlineto} for
           -4 1 4
          {-4 smoveto
           0 8 srlineto} for
            ]
\end{pspicture}
\end{minipage}
